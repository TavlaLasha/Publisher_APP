from django.shortcuts import render
from encodings import utf_8
from docx import Document
from docx.enum.text import WD_TAB_ALIGNMENT, WD_TAB_LEADER
from docx.oxml.ns import qn
from htmldocx import HtmlToDocx
from django.views.decorators.csrf import csrf_exempt
from lxml import html
from lxml.html import etree
import os.path
import win32com.client

word = win32com.client.Dispatch("Word.application")

def HYPconsonants(text):
    varData = []
    #region
    varData.append([4305, 4306])
    varData.append([4305, 4307])
    varData.append([4305, 4309])
    varData.append([4305, 4310])
    varData.append([4305, 4311])
    varData.append([4305, 4313])
    varData.append([4305, 4314])
    varData.append([4305, 4315])
    varData.append([4305, 4316])
    varData.append([4305, 4318])
    varData.append([4305, 4319])
    varData.append([4305, 4320])
    varData.append([4305, 4321])
    varData.append([4305, 4322])
    varData.append([4305, 4324])
    varData.append([4305, 4325])
    varData.append([4305, 4326])
    varData.append([4305, 4327])
    varData.append([4305, 4328])
    varData.append([4305, 4329])
    varData.append([4305, 4330])
    varData.append([4305, 4331])
    varData.append([4305, 4332])
    varData.append([4305, 4333])
    varData.append([4305, 4334])
    varData.append([4305, 4335])
    varData.append([4305, 4336])
    varData.append([4306, 4305])
    varData.append([4306, 4307])
    varData.append([4306, 4309])
    varData.append([4306, 4310])
    varData.append([4306, 4311])
    varData.append([4306, 4313])
    varData.append([4306, 4314])
    varData.append([4306, 4315])
    varData.append([4306, 4316])
    varData.append([4306, 4318])
    varData.append([4306, 4319])
    varData.append([4306, 4320])
    varData.append([4306, 4321])
    varData.append([4306, 4322])
    varData.append([4306, 4324])
    varData.append([4306, 4325])
    varData.append([4306, 4326])
    varData.append([4306, 4327])
    varData.append([4306, 4328])
    varData.append([4306, 4329])
    varData.append([4306, 4330])
    varData.append([4306, 4331])
    varData.append([4306, 4332])
    varData.append([4306, 4333])
    varData.append([4306, 4334])
    varData.append([4306, 4335])
    varData.append([4306, 4336])
    varData.append([4307, 4305])
    varData.append([4307, 4306])
    varData.append([4307, 4309])
    varData.append([4307, 4310])
    varData.append([4307, 4311])
    varData.append([4307, 4313])
    varData.append([4307, 4314])
    varData.append([4307, 4315])
    varData.append([4307, 4316])
    varData.append([4307, 4318])
    varData.append([4307, 4319])
    varData.append([4307, 4320])
    varData.append([4307, 4321])
    varData.append([4307, 4322])
    varData.append([4307, 4324])
    varData.append([4307, 4325])
    varData.append([4307, 4326])
    varData.append([4307, 4327])
    varData.append([4307, 4328])
    varData.append([4307, 4329])
    varData.append([4307, 4330])
    varData.append([4307, 4331])
    varData.append([4307, 4332])
    varData.append([4307, 4333])
    varData.append([4307, 4334])
    varData.append([4307, 4335])
    varData.append([4307, 4336])
    varData.append([4309, 4305])
    varData.append([4309, 4306])
    varData.append([4309, 4307])
    varData.append([4309, 4310])
    varData.append([4309, 4311])
    varData.append([4309, 4313])
    varData.append([4309, 4314])
    varData.append([4309, 4315])
    varData.append([4309, 4316])
    varData.append([4309, 4318])
    varData.append([4309, 4319])
    varData.append([4309, 4320])
    varData.append([4309, 4321])
    varData.append([4309, 4322])
    varData.append([4309, 4324])
    varData.append([4309, 4325])
    varData.append([4309, 4326])
    varData.append([4309, 4327])
    varData.append([4309, 4328])
    varData.append([4309, 4329])
    varData.append([4309, 4330])
    varData.append([4309, 4331])
    varData.append([4309, 4332])
    varData.append([4309, 4333])
    varData.append([4309, 4334])
    varData.append([4309, 4335])
    varData.append([4309, 4336])
    varData.append([4310, 4305])
    varData.append([4310, 4306])
    varData.append([4310, 4307])
    varData.append([4310, 4309])
    varData.append([4310, 4311])
    varData.append([4310, 4313])
    varData.append([4310, 4314])
    varData.append([4310, 4315])
    varData.append([4310, 4316])
    varData.append([4310, 4318])
    varData.append([4310, 4319])
    varData.append([4310, 4320])
    varData.append([4310, 4321])
    varData.append([4310, 4322])
    varData.append([4310, 4324])
    varData.append([4310, 4325])
    varData.append([4310, 4326])
    varData.append([4310, 4327])
    varData.append([4310, 4328])
    varData.append([4310, 4329])
    varData.append([4310, 4330])
    varData.append([4310, 4331])
    varData.append([4310, 4332])
    varData.append([4310, 4333])
    varData.append([4310, 4334])
    varData.append([4310, 4335])
    varData.append([4310, 4336])
    varData.append([4311, 4305])
    varData.append([4311, 4306])
    varData.append([4311, 4307])
    varData.append([4311, 4309])
    varData.append([4311, 4310])
    varData.append([4311, 4313])
    varData.append([4311, 4314])
    varData.append([4311, 4315])
    varData.append([4311, 4316])
    varData.append([4311, 4318])
    varData.append([4311, 4319])
    varData.append([4311, 4320])
    varData.append([4311, 4321])
    varData.append([4311, 4322])
    varData.append([4311, 4324])
    varData.append([4311, 4325])
    varData.append([4311, 4326])
    varData.append([4311, 4327])
    varData.append([4311, 4328])
    varData.append([4311, 4329])
    varData.append([4311, 4330])
    varData.append([4311, 4331])
    varData.append([4311, 4332])
    varData.append([4311, 4333])
    varData.append([4311, 4334])
    varData.append([4311, 4335])
    varData.append([4311, 4336])
    varData.append([4313, 4305])
    varData.append([4313, 4306])
    varData.append([4313, 4307])
    varData.append([4313, 4309])
    varData.append([4313, 4310])
    varData.append([4313, 4311])
    varData.append([4313, 4314])
    varData.append([4313, 4315])
    varData.append([4313, 4316])
    varData.append([4313, 4318])
    varData.append([4313, 4319])
    varData.append([4313, 4320])
    varData.append([4313, 4321])
    varData.append([4313, 4322])
    varData.append([4313, 4324])
    varData.append([4313, 4325])
    varData.append([4313, 4326])
    varData.append([4313, 4327])
    varData.append([4313, 4328])
    varData.append([4313, 4329])
    varData.append([4313, 4330])
    varData.append([4313, 4331])
    varData.append([4313, 4332])
    varData.append([4313, 4333])
    varData.append([4313, 4334])
    varData.append([4313, 4335])
    varData.append([4313, 4336])
    varData.append([4314, 4305])
    varData.append([4314, 4306])
    varData.append([4314, 4307])
    varData.append([4314, 4309])
    varData.append([4314, 4310])
    varData.append([4314, 4311])
    varData.append([4314, 4313])
    varData.append([4314, 4315])
    varData.append([4314, 4316])
    varData.append([4314, 4318])
    varData.append([4314, 4319])
    varData.append([4314, 4320])
    varData.append([4314, 4321])
    varData.append([4314, 4322])
    varData.append([4314, 4324])
    varData.append([4314, 4325])
    varData.append([4314, 4326])
    varData.append([4314, 4327])
    varData.append([4314, 4328])
    varData.append([4314, 4329])
    varData.append([4314, 4330])
    varData.append([4314, 4331])
    varData.append([4314, 4332])
    varData.append([4314, 4333])
    varData.append([4314, 4334])
    varData.append([4314, 4335])
    varData.append([4314, 4336])
    varData.append([4315, 4305])
    varData.append([4315, 4306])
    varData.append([4315, 4307])
    varData.append([4315, 4309])
    varData.append([4315, 4310])
    varData.append([4315, 4311])
    varData.append([4315, 4313])
    varData.append([4315, 4314])
    varData.append([4315, 4316])
    varData.append([4315, 4318])
    varData.append([4315, 4319])
    varData.append([4315, 4320])
    varData.append([4315, 4321])
    varData.append([4315, 4322])
    varData.append([4315, 4324])
    varData.append([4315, 4325])
    varData.append([4315, 4326])
    varData.append([4315, 4327])
    varData.append([4315, 4328])
    varData.append([4315, 4329])
    varData.append([4315, 4330])
    varData.append([4315, 4331])
    varData.append([4315, 4332])
    varData.append([4315, 4333])
    varData.append([4315, 4334])
    varData.append([4315, 4335])
    varData.append([4315, 4336])
    varData.append([4316, 4305])
    varData.append([4316, 4306])
    varData.append([4316, 4307])
    varData.append([4316, 4309])
    varData.append([4316, 4310])
    varData.append([4316, 4311])
    varData.append([4316, 4313])
    varData.append([4316, 4314])
    varData.append([4316, 4315])
    varData.append([4316, 4318])
    varData.append([4316, 4319])
    varData.append([4316, 4320])
    varData.append([4316, 4321])
    varData.append([4316, 4322])
    varData.append([4316, 4324])
    varData.append([4316, 4325])
    varData.append([4316, 4326])
    varData.append([4316, 4327])
    varData.append([4316, 4328])
    varData.append([4316, 4329])
    varData.append([4316, 4330])
    varData.append([4316, 4331])
    varData.append([4316, 4332])
    varData.append([4316, 4333])
    varData.append([4316, 4334])
    varData.append([4316, 4335])
    varData.append([4316, 4336])
    varData.append([4318, 4305])
    varData.append([4318, 4306])
    varData.append([4318, 4307])
    varData.append([4318, 4309])
    varData.append([4318, 4310])
    varData.append([4318, 4311])
    varData.append([4318, 4313])
    varData.append([4318, 4314])
    varData.append([4318, 4315])
    varData.append([4318, 4316])
    varData.append([4318, 4319])
    varData.append([4318, 4320])
    varData.append([4318, 4321])
    varData.append([4318, 4322])
    varData.append([4318, 4324])
    varData.append([4318, 4325])
    varData.append([4318, 4326])
    varData.append([4318, 4327])
    varData.append([4318, 4328])
    varData.append([4318, 4329])
    varData.append([4318, 4330])
    varData.append([4318, 4331])
    varData.append([4318, 4332])
    varData.append([4318, 4333])
    varData.append([4318, 4334])
    varData.append([4318, 4335])
    varData.append([4318, 4336])
    varData.append([4319, 4305])
    varData.append([4319, 4306])
    varData.append([4319, 4307])
    varData.append([4319, 4309])
    varData.append([4319, 4310])
    varData.append([4319, 4311])
    varData.append([4319, 4313])
    varData.append([4319, 4314])
    varData.append([4319, 4315])
    varData.append([4319, 4316])
    varData.append([4319, 4318])
    varData.append([4319, 4320])
    varData.append([4319, 4321])
    varData.append([4319, 4322])
    varData.append([4319, 4324])
    varData.append([4319, 4325])
    varData.append([4319, 4326])
    varData.append([4319, 4327])
    varData.append([4319, 4328])
    varData.append([4319, 4329])
    varData.append([4319, 4330])
    varData.append([4319, 4331])
    varData.append([4319, 4332])
    varData.append([4319, 4333])
    varData.append([4319, 4334])
    varData.append([4319, 4335])
    varData.append([4319, 4336])
    varData.append([4320, 4305])
    varData.append([4320, 4306])
    varData.append([4320, 4307])
    varData.append([4320, 4309])
    varData.append([4320, 4310])
    varData.append([4320, 4311])
    varData.append([4320, 4313])
    varData.append([4320, 4314])
    varData.append([4320, 4315])
    varData.append([4320, 4316])
    varData.append([4320, 4318])
    varData.append([4320, 4319])
    varData.append([4320, 4321])
    varData.append([4320, 4322])
    varData.append([4320, 4324])
    varData.append([4320, 4325])
    varData.append([4320, 4326])
    varData.append([4320, 4327])
    varData.append([4320, 4328])
    varData.append([4320, 4329])
    varData.append([4320, 4330])
    varData.append([4320, 4331])
    varData.append([4320, 4332])
    varData.append([4320, 4333])
    varData.append([4320, 4334])
    varData.append([4320, 4335])
    varData.append([4320, 4336])
    varData.append([4321, 4305])
    varData.append([4321, 4306])
    varData.append([4321, 4307])
    varData.append([4321, 4309])
    varData.append([4321, 4310])
    varData.append([4321, 4311])
    varData.append([4321, 4313])
    varData.append([4321, 4314])
    varData.append([4321, 4315])
    varData.append([4321, 4316])
    varData.append([4321, 4318])
    varData.append([4321, 4319])
    varData.append([4321, 4320])
    varData.append([4321, 4322])
    varData.append([4321, 4324])
    varData.append([4321, 4325])
    varData.append([4321, 4326])
    varData.append([4321, 4327])
    varData.append([4321, 4328])
    varData.append([4321, 4329])
    varData.append([4321, 4330])
    varData.append([4321, 4331])
    varData.append([4321, 4332])
    varData.append([4321, 4333])
    varData.append([4321, 4334])
    varData.append([4321, 4335])
    varData.append([4321, 4336])
    varData.append([4322, 4305])
    varData.append([4322, 4306])
    varData.append([4322, 4307])
    varData.append([4322, 4309])
    varData.append([4322, 4310])
    varData.append([4322, 4311])
    varData.append([4322, 4313])
    varData.append([4322, 4314])
    varData.append([4322, 4315])
    varData.append([4322, 4316])
    varData.append([4322, 4318])
    varData.append([4322, 4319])
    varData.append([4322, 4320])
    varData.append([4322, 4321])
    varData.append([4322, 4324])
    varData.append([4322, 4325])
    varData.append([4322, 4326])
    varData.append([4322, 4327])
    varData.append([4322, 4328])
    varData.append([4322, 4329])
    varData.append([4322, 4330])
    varData.append([4322, 4331])
    varData.append([4322, 4332])
    varData.append([4322, 4333])
    varData.append([4322, 4334])
    varData.append([4322, 4335])
    varData.append([4322, 4336])
    varData.append([4324, 4305])
    varData.append([4324, 4306])
    varData.append([4324, 4307])
    varData.append([4324, 4309])
    varData.append([4324, 4310])
    varData.append([4324, 4311])
    varData.append([4324, 4313])
    varData.append([4324, 4314])
    varData.append([4324, 4315])
    varData.append([4324, 4316])
    varData.append([4324, 4318])
    varData.append([4324, 4319])
    varData.append([4324, 4320])
    varData.append([4324, 4321])
    varData.append([4324, 4322])
    varData.append([4324, 4325])
    varData.append([4324, 4326])
    varData.append([4324, 4327])
    varData.append([4324, 4328])
    varData.append([4324, 4329])
    varData.append([4324, 4330])
    varData.append([4324, 4331])
    varData.append([4324, 4332])
    varData.append([4324, 4333])
    varData.append([4324, 4334])
    varData.append([4324, 4335])
    varData.append([4324, 4336])
    varData.append([4325, 4305])
    varData.append([4325, 4306])
    varData.append([4325, 4307])
    varData.append([4325, 4309])
    varData.append([4325, 4310])
    varData.append([4325, 4311])
    varData.append([4325, 4313])
    varData.append([4325, 4314])
    varData.append([4325, 4315])
    varData.append([4325, 4316])
    varData.append([4325, 4318])
    varData.append([4325, 4319])
    varData.append([4325, 4320])
    varData.append([4325, 4321])
    varData.append([4325, 4322])
    varData.append([4325, 4324])
    varData.append([4325, 4326])
    varData.append([4325, 4327])
    varData.append([4325, 4328])
    varData.append([4325, 4329])
    varData.append([4325, 4330])
    varData.append([4325, 4331])
    varData.append([4325, 4332])
    varData.append([4325, 4333])
    varData.append([4325, 4334])
    varData.append([4325, 4335])
    varData.append([4325, 4336])
    varData.append([4326, 4305])
    varData.append([4326, 4306])
    varData.append([4326, 4307])
    varData.append([4326, 4309])
    varData.append([4326, 4310])
    varData.append([4326, 4311])
    varData.append([4326, 4313])
    varData.append([4326, 4314])
    varData.append([4326, 4315])
    varData.append([4326, 4316])
    varData.append([4326, 4318])
    varData.append([4326, 4319])
    varData.append([4326, 4320])
    varData.append([4326, 4321])
    varData.append([4326, 4322])
    varData.append([4326, 4324])
    varData.append([4326, 4325])
    varData.append([4326, 4327])
    varData.append([4326, 4328])
    varData.append([4326, 4329])
    varData.append([4326, 4330])
    varData.append([4326, 4331])
    varData.append([4326, 4332])
    varData.append([4326, 4333])
    varData.append([4326, 4334])
    varData.append([4326, 4335])
    varData.append([4326, 4336])
    varData.append([4327, 4305])
    varData.append([4327, 4306])
    varData.append([4327, 4307])
    varData.append([4327, 4309])
    varData.append([4327, 4310])
    varData.append([4327, 4311])
    varData.append([4327, 4313])
    varData.append([4327, 4314])
    varData.append([4327, 4315])
    varData.append([4327, 4316])
    varData.append([4327, 4318])
    varData.append([4327, 4319])
    varData.append([4327, 4320])
    varData.append([4327, 4321])
    varData.append([4327, 4322])
    varData.append([4327, 4324])
    varData.append([4327, 4325])
    varData.append([4327, 4326])
    varData.append([4327, 4328])
    varData.append([4327, 4329])
    varData.append([4327, 4330])
    varData.append([4327, 4331])
    varData.append([4327, 4332])
    varData.append([4327, 4333])
    varData.append([4327, 4334])
    varData.append([4327, 4335])
    varData.append([4327, 4336])
    varData.append([4328, 4305])
    varData.append([4328, 4306])
    varData.append([4328, 4307])
    varData.append([4328, 4309])
    varData.append([4328, 4310])
    varData.append([4328, 4311])
    varData.append([4328, 4313])
    varData.append([4328, 4314])
    varData.append([4328, 4315])
    varData.append([4328, 4316])
    varData.append([4328, 4318])
    varData.append([4328, 4319])
    varData.append([4328, 4320])
    varData.append([4328, 4321])
    varData.append([4328, 4322])
    varData.append([4328, 4324])
    varData.append([4328, 4325])
    varData.append([4328, 4326])
    varData.append([4328, 4327])
    varData.append([4328, 4329])
    varData.append([4328, 4330])
    varData.append([4328, 4331])
    varData.append([4328, 4332])
    varData.append([4328, 4333])
    varData.append([4328, 4334])
    varData.append([4328, 4335])
    varData.append([4328, 4336])
    varData.append([4329, 4305])
    varData.append([4329, 4306])
    varData.append([4329, 4307])
    varData.append([4329, 4309])
    varData.append([4329, 4310])
    varData.append([4329, 4311])
    varData.append([4329, 4313])
    varData.append([4329, 4314])
    varData.append([4329, 4315])
    varData.append([4329, 4316])
    varData.append([4329, 4318])
    varData.append([4329, 4319])
    varData.append([4329, 4320])
    varData.append([4329, 4321])
    varData.append([4329, 4322])
    varData.append([4329, 4324])
    varData.append([4329, 4325])
    varData.append([4329, 4326])
    varData.append([4329, 4327])
    varData.append([4329, 4328])
    varData.append([4329, 4330])
    varData.append([4329, 4331])
    varData.append([4329, 4332])
    varData.append([4329, 4333])
    varData.append([4329, 4334])
    varData.append([4329, 4335])
    varData.append([4329, 4336])
    varData.append([4330, 4305])
    varData.append([4330, 4306])
    varData.append([4330, 4307])
    varData.append([4330, 4309])
    varData.append([4330, 4310])
    varData.append([4330, 4311])
    varData.append([4330, 4313])
    varData.append([4330, 4314])
    varData.append([4330, 4315])
    varData.append([4330, 4316])
    varData.append([4330, 4318])
    varData.append([4330, 4319])
    varData.append([4330, 4320])
    varData.append([4330, 4321])
    varData.append([4330, 4322])
    varData.append([4330, 4324])
    varData.append([4330, 4325])
    varData.append([4330, 4326])
    varData.append([4330, 4327])
    varData.append([4330, 4328])
    varData.append([4330, 4329])
    varData.append([4330, 4331])
    varData.append([4330, 4332])
    varData.append([4330, 4333])
    varData.append([4330, 4334])
    varData.append([4330, 4335])
    varData.append([4330, 4336])
    varData.append([4331, 4305])
    varData.append([4331, 4306])
    varData.append([4331, 4307])
    varData.append([4331, 4309])
    varData.append([4331, 4310])
    varData.append([4331, 4311])
    varData.append([4331, 4313])
    varData.append([4331, 4314])
    varData.append([4331, 4315])
    varData.append([4331, 4316])
    varData.append([4331, 4318])
    varData.append([4331, 4319])
    varData.append([4331, 4320])
    varData.append([4331, 4321])
    varData.append([4331, 4322])
    varData.append([4331, 4324])
    varData.append([4331, 4325])
    varData.append([4331, 4326])
    varData.append([4331, 4327])
    varData.append([4331, 4328])
    varData.append([4331, 4329])
    varData.append([4331, 4330])
    varData.append([4331, 4332])
    varData.append([4331, 4333])
    varData.append([4331, 4334])
    varData.append([4331, 4335])
    varData.append([4331, 4336])
    varData.append([4332, 4305])
    varData.append([4332, 4306])
    varData.append([4332, 4307])
    varData.append([4332, 4309])
    varData.append([4332, 4310])
    varData.append([4332, 4311])
    varData.append([4332, 4313])
    varData.append([4332, 4314])
    varData.append([4332, 4315])
    varData.append([4332, 4316])
    varData.append([4332, 4318])
    varData.append([4332, 4319])
    varData.append([4332, 4320])
    varData.append([4332, 4321])
    varData.append([4332, 4322])
    varData.append([4332, 4324])
    varData.append([4332, 4325])
    varData.append([4332, 4326])
    varData.append([4332, 4327])
    varData.append([4332, 4328])
    varData.append([4332, 4329])
    varData.append([4332, 4330])
    varData.append([4332, 4331])
    varData.append([4332, 4332])
    varData.append([4332, 4333])
    varData.append([4332, 4334])
    varData.append([4332, 4335])
    varData.append([4332, 4336])
    varData.append([4333, 4305])
    varData.append([4333, 4306])
    varData.append([4333, 4307])
    varData.append([4333, 4309])
    varData.append([4333, 4310])
    varData.append([4333, 4311])
    varData.append([4333, 4313])
    varData.append([4333, 4314])
    varData.append([4333, 4315])
    varData.append([4333, 4316])
    varData.append([4333, 4318])
    varData.append([4333, 4319])
    varData.append([4333, 4320])
    varData.append([4333, 4321])
    varData.append([4333, 4322])
    varData.append([4333, 4324])
    varData.append([4333, 4325])
    varData.append([4333, 4326])
    varData.append([4333, 4327])
    varData.append([4333, 4328])
    varData.append([4333, 4329])
    varData.append([4333, 4330])
    varData.append([4333, 4331])
    varData.append([4333, 4332])
    varData.append([4333, 4334])
    varData.append([4333, 4335])
    varData.append([4333, 4336])
    varData.append([4334, 4305])
    varData.append([4334, 4306])
    varData.append([4334, 4307])
    varData.append([4334, 4309])
    varData.append([4334, 4310])
    varData.append([4334, 4311])
    varData.append([4334, 4313])
    varData.append([4334, 4314])
    varData.append([4334, 4315])
    varData.append([4334, 4316])
    varData.append([4334, 4318])
    varData.append([4334, 4319])
    varData.append([4334, 4320])
    varData.append([4334, 4321])
    varData.append([4334, 4322])
    varData.append([4334, 4324])
    varData.append([4334, 4325])
    varData.append([4334, 4326])
    varData.append([4334, 4327])
    varData.append([4334, 4328])
    varData.append([4334, 4329])
    varData.append([4334, 4330])
    varData.append([4334, 4331])
    varData.append([4334, 4332])
    varData.append([4334, 4333])
    varData.append([4334, 4335])
    varData.append([4334, 4336])
    varData.append([4335, 4305])
    varData.append([4335, 4306])
    varData.append([4335, 4307])
    varData.append([4335, 4309])
    varData.append([4335, 4310])
    varData.append([4335, 4311])
    varData.append([4335, 4313])
    varData.append([4335, 4314])
    varData.append([4335, 4315])
    varData.append([4335, 4316])
    varData.append([4335, 4318])
    varData.append([4335, 4319])
    varData.append([4335, 4320])
    varData.append([4335, 4321])
    varData.append([4335, 4322])
    varData.append([4335, 4324])
    varData.append([4335, 4325])
    varData.append([4335, 4326])
    varData.append([4335, 4327])
    varData.append([4335, 4328])
    varData.append([4335, 4329])
    varData.append([4335, 4330])
    varData.append([4335, 4331])
    varData.append([4335, 4332])
    varData.append([4335, 4333])
    varData.append([4335, 4334])
    varData.append([4335, 4336])
    varData.append([4336, 4305])
    varData.append([4336, 4306])
    varData.append([4336, 4307])
    varData.append([4336, 4309])
    varData.append([4336, 4310])
    varData.append([4336, 4311])
    varData.append([4336, 4313])
    varData.append([4336, 4314])
    varData.append([4336, 4315])
    varData.append([4336, 4316])
    varData.append([4336, 4318])
    varData.append([4336, 4319])
    varData.append([4336, 4320])
    varData.append([4336, 4321])
    varData.append([4336, 4322])
    varData.append([4336, 4324])
    varData.append([4336, 4325])
    varData.append([4336, 4326])
    varData.append([4336, 4327])
    varData.append([4336, 4328])
    varData.append([4336, 4329])
    varData.append([4336, 4330])
    varData.append([4336, 4331])
    varData.append([4336, 4332])
    varData.append([4336, 4333])
    varData.append([4336, 4334])
    varData.append([4336, 4335])
    #endregion

    for i in range(756):
        text = text.replace(chr(varData[i][0])+chr(varData[i][1]), chr(varData[i][0])+ u'\u00AD' +chr(varData[i][1]))
    
    return text
     

def HYPwovels(text):

    varData=[]
    varData.append(4304)
    varData.append(4308)
    varData.append(4312)
    varData.append(4317)
    varData.append(4323)

    for i in varData:
        text = text.replace(chr(i), chr(i) + u'\u00AD')

    return text

def HYPcleanfirst(text):

    varData=[]
    varData.append(" ")
    varData.append("(")
    varData.append(u'\u201E')
    varData.append(u'\u000A')

    for letter in range(4304, 4337):
        for c in varData:
            if text.find(chr(letter) + u'\u00AD',0,2) != -1:
                index = text.find(chr(letter) + u'\u00AD', 0,2)+1
                text= text[0:index:]+text[index+1: :]
            else:
                text = text.replace(c + chr(letter) + u'\u00AD', c + chr(letter))

    return text

def HYPcleanlast(text):

    varData=[]
    #region
    varData.append(' ')
    varData.append('.')
    varData.append(',')
    varData.append('!')
    varData.append('?')
    varData.append(')')
    varData.append('-')
    varData.append(';')
    varData.append(':')
    varData.append(u'\u201C')
    #endregion

    txtlen = len(text)

    for letter in range(4304, 4337):
        for c in varData:
            if text.rfind(chr(letter) + u'\u00AD',txtlen-2, txtlen) != -1:
                index = text.rfind(chr(letter) + u'\u00AD', txtlen-2,txtlen)+1
                text = text[0:index:]+text[index+1: :]

            if text.rfind(u'\u00AD' + chr(letter),txtlen-3,txtlen) != -1:
                index = text.rfind(u'\u00AD' + chr(letter), txtlen-3,txtlen)
                text= text[0:index:]+text[index+1: :]
            else:
                text = text.replace(chr(letter) + u'\u00AD' + c, chr(letter) + c)
                text = text.replace(u'\u00AD' + chr(letter) + c, chr(letter) + c)

    return text


def HYPcleanlastconpunct(text):
        
    varDataPunct=[]
    #region
    varDataPunct.append(' ')
    varDataPunct.append('.')
    varDataPunct.append(',')
    varDataPunct.append('!')
    varDataPunct.append('?')
    varDataPunct.append(')')
    varDataPunct.append('-')
    varDataPunct.append(';')
    varDataPunct.append(':')
    varDataPunct.append(u'\u201C')
    #endregion

    varData=[]
    #region
    varData.append([4305, 4321])
    varData.append([4314, 4321])
    varData.append([4309, 4321])
    varData.append([4305, 4311])
    varData.append([4316, 4321])
    varData.append([4320, 4321])
    varData.append([4322, 4321])
    varData.append([4309, 4311])
    varData.append([4315, 4321])
    varData.append([4320, 4311])
    varData.append([4311, 4321])
    varData.append([4307, 4321])
    varData.append([4313, 4321])
    varData.append([4316, 4311])
    varData.append([4306, 4321])
    varData.append([4310, 4321])
    varData.append([4314, 4311])
    varData.append([4334, 4321])
    varData.append([4324, 4321])
    varData.append([4315, 4311])
    varData.append([4305, 4320])
    varData.append([4325, 4321])
    varData.append([4321, 4322])
    varData.append([4328, 4321])
    varData.append([4316, 4307])
    varData.append([4316, 4322])
    varData.append([4320, 4307])
    varData.append([4316, 4306])
    varData.append([4330, 4321])
    varData.append([4329, 4321])
    varData.append([4318, 4321])
    varData.append([4320, 4322])
    varData.append([4335, 4321])
    varData.append([4319, 4321])
    varData.append([4316, 4330])
    varData.append([4315, 4330])
    varData.append([4314, 4307])
    varData.append([4321, 4311])
    varData.append([4322, 4320])
    varData.append([4324, 4311])
    varData.append([4309, 4316])
    varData.append([4320, 4330])
    varData.append([4326, 4321])
    varData.append([4305, 4316])
    varData.append([4320, 4313])
    varData.append([4315, 4307])
    varData.append([4314, 4315])
    varData.append([4320, 4316])
    varData.append([4305, 4314])
    varData.append([4309, 4314])
    varData.append([4331, 4321])
    varData.append([4333, 4321])
    varData.append([4321, 4313])
    varData.append([4311, 4334])
    varData.append([4307, 4320]) # დ და რ
    varData.append([4311, 4316])
    varData.append([4327, 4321])
    varData.append([4314, 4316])
    #endregion
    
    txtlen = len(text)
    for s in varDataPunct:
        for t in range(57):
            if text.rfind(u'\u00AD' + chr(varData[t][0])+chr(varData[t][1]),txtlen-4, txtlen) != -1:
                index = text.rfind(u'\u00AD' + chr(varData[t][0])+chr(varData[t][1]), txtlen-4,txtlen)
                text = text[0:index:]+text[index+1: :]
            else:
                text = text.replace(u'\u00AD' + chr(varData[t][0])+chr(varData[t][1]) + s, chr(varData[t][0])+chr(varData[t][1]) + s)

    return text

def callAll(text):
    text = HYPconsonants(text)
    text = HYPwovels(text)
    text = HYPcleanfirst(text)
    text = HYPcleanlast(text)
    text = HYPcleanlastconpunct(text)
    return text
    
def get_para_data(output_doc_name, paragraph):
    """
    Write the run to the new file and then set its font, bold, alignment, color etc. data.
    """
    output_para = output_doc_name.add_paragraph()
    for run in paragraph.runs:
        output_run = output_para.add_run(callAll(run.text))
        # Run's size data
        output_run.font.size = run.font.size
        # Run's font family data
        output_run.font.name = run.font.name
        # Run's bold data
        output_run.bold = run.bold
        # Run's italic data
        output_run.italic = run.italic
        # Run's underline data
        output_run.underline = run.underline
        # Run's color data
        output_run.font.color.rgb = run.font.color.rgb
        # Run's font data
        output_run.style.name = run.style.name
    # Paragraph's alignment data
    output_para.paragraph_format.alignment = paragraph.paragraph_format.alignment
    output_para.paragraph_format.line_spacing = paragraph.paragraph_format.line_spacing
    output_para.paragraph_format.first_line_indent = paragraph.paragraph_format.first_line_indent



    

@csrf_exempt
def index(request):
    # document = Document('/home/aivazashvilitekla/Desktop/demo2.docx')
    # document = Document('C:/Users/lasha/Desktop/hypernated_demo2.docx')
    # final_doc = Document()

    # for i in document.paragraphs:
    #     get_para_data(final_doc, i)

    # dt = final_doc.text
    if request.method == "POST":
        
        # Func = open("test.html","w",encoding="utf-8")
        # Func.write('<html><head><meta http-equiv=Content-Type content="text/html; charset=utf-8"></head>'+request.POST["tx"]+'</html>')
        # Func.close()

        file_path = os.path.abspath('hypernated_demo2.doc')
        docx_file = os.path.abspath('hypernated_demo3.docx')
        print(file_path)
        wordDoc = word.Documents.Open(file_path)
        wordDoc.SaveAs2(docx_file, FileFormat = 16)
        wordDoc.Close()

        # new_parser = HtmlToDocx()
        # new_parser.parse_html_file("test.html", "final_doc")
        

    # final_doc.save('C:/Users/lasha/Desktop/hyp.docx')
    return render(request, 'index.html')

